import{E as L,a5 as R,F as _,a6 as B,I as z,L as d,M as h,bn as U,a2 as k,H as p,a9 as b,a8 as S,ah as w,Y as V,G as f,aj as E,ai as K,b8 as H,b9 as I,ac as A,aI as j,aR as M,bo as P,aK as G,aG as x,aB as T}from"./vendor-4a8d1cde.js";import{h as q,A as J,c as O,b as Q}from"./index-af001a19.js";const Y=async c=>{const{page:n,size:t}=c;return q({url:"/feature/table",method:"post",data:{page:n,size:t},headers:{Authorization:sessionStorage.getItem(J)}})},W=L({name:"BaseTable",__name:"BaseTable",props:{headers:{},data:{},border:{type:Boolean,default:!0},singleColumn:{type:Boolean,default:!1},singleLine:{type:Boolean,default:!1},size:{default:"medium"},striped:{type:Boolean,default:!0},maxHeight:{default:void 0},minHeight:{default:void 0},loading:{type:Boolean,default:!1},pagination:{default:void 0},rowKey:{default:"id"},searchValue:{default:""},scrollX:{default:void 0},isEnableVirtualScroll:{type:Boolean,default:!1}},emits:["checkedRowKeys"],setup(c){const n=c,t=R(()=>!!(n.isEnableVirtualScroll&&n.maxHeight)),o=e=>e.id;return(e,r)=>{const m=U;return _(),B("div",null,[z(e.$slots,"search"),z(e.$slots,"handle"),d(m,{columns:e.headers,data:e.data,bordered:e.border,"single-column":e.singleColumn,"single-line":e.singleLine,size:e.size,striped:e.striped,"max-height":e.maxHeight,"min-height":e.minHeight,loading:e.loading,pagination:e.pagination,remote:!0,"paginate-single-page":!0,"row-key":o,"scroll-x":e.scrollX,"virtual-scroll":h(t),onUpdateCheckedRowKeys:r[0]||(r[0]=l=>e.$emit("checkedRowKeys",l))},null,8,["columns","data","bordered","single-column","single-line","size","striped","max-height","min-height","loading","pagination","scroll-x","virtual-scroll"])])}}}),Z={class:"w-full flex items-center justify-between"},ee={class:"space-x-2"},ae=L({__name:"BaseTableHandle",props:{value:{default:""}},emits:["add","into","export"],setup(c){return(n,t)=>{const o=S;return _(),B("div",Z,[k("div",null,[d(o,{type:"primary",size:"small",class:"px-6 py-2",onClick:t[0]||(t[0]=e=>n.$emit("add"))},{default:p(()=>[b(" 新增 ")]),_:1})]),k("div",ee,[d(o,{type:"primary",size:"small",class:"px-6 py-2",onClick:t[1]||(t[1]=e=>n.$emit("into"))},{default:p(()=>[b(" 导入 ")]),_:1}),d(o,{type:"info",size:"small",ghost:"",class:"px-6 py-2",onClick:t[2]||(t[2]=e=>n.$emit("export"))},{default:p(()=>[b(" 导出 ")]),_:1})])])}}}),te={class:"space-x-2"},le=L({__name:"BaseTableSearch",props:{searchFormList:{type:Array,default:()=>[]}},emits:["update:searchFormList","search","reset"],setup(c,{emit:n}){const o=w(c.searchFormList);return V(o,e=>{n("update:searchFormList",e)},{deep:!0}),(e,r)=>{const m=j,l=M,g=P,u=H,s=S,v=I;return _(),f(v,{"label-placement":"left","label-width":"auto"},{default:p(()=>[(_(!0),B(K,null,E(h(o),a=>(_(),f(u,{key:a.key,label:a.label},{default:p(()=>[a.type==="input"?(_(),f(m,{key:0,value:a.value,"onUpdate:value":y=>a.value=y,placeholder:a.placeholder},null,8,["value","onUpdate:value","placeholder"])):a.type==="select"?(_(),f(l,{key:1,value:a.value,"onUpdate:value":y=>a.value=y,placeholder:a.placeholder,options:a.options},null,8,["value","onUpdate:value","placeholder","options"])):a.type==="date"?(_(),f(g,{key:2,"formatted-value":a.value,"onUpdate:formattedValue":y=>a.value=y,type:"date",class:"w-full",placeholder:a.placeholder},null,8,["formatted-value","onUpdate:formattedValue","placeholder"])):A("",!0)]),_:2},1032,["label"]))),128)),d(u,null,{default:p(()=>[k("div",te,[d(s,{type:"primary",class:"px-6",onClick:r[0]||(r[0]=a=>e.$emit("search"))},{default:p(()=>[b(" 搜索 ")]),_:1}),d(s,{type:"primary",class:"px-6",ghost:"",onClick:r[1]||(r[1]=a=>e.$emit("reset"))},{default:p(()=>[b(" 重置 ")]),_:1})])]),_:1})]),_:1})}}}),oe=()=>{const{isLoading:c,withLoading:n}=O(),t=w(),o=w({page:1,pageSize:20,pageSizes:[5,10,15,20,30],pageCount:10,showSizePicker:!0,showQuickJumper:!0});return{isLoading:c,pagination:o,tableData:t,getTableData:async m=>{let l={list:[],total:0};const g=await n(async()=>{const{data:u}=await m();return t.value=u.list,u});return g&&(l=g),l},exportExcel:(m,l,g,u)=>{let s;u?s=XLSX.utils.json_to_sheet(u):s=XLSX.utils.json_to_sheet(t.value??[]);const v=XLSX.utils.book_new();g&&XLSX.utils.sheet_add_aoa(s,[g],{origin:"A1"}),XLSX.utils.book_append_sheet(v,s,m??"Sheet1"),XLSX.writeFile(v,`${l}.xlsx`,{compression:!0})}}},ne={class:"border border-vBorderLight dark:border-vBorderDark rounded p-4 mb-2"},se={class:"mb-2 flex items-center justify-end space-x-1"},ue=L({__name:"Table",setup(c){const{success:n,error:t,info:o}=Q(),e=w(""),{isLoading:r,tableData:m,pagination:l,getTableData:g}=oe(),u=[{type:"selection"},{title:"序号",key:"id"},{title:"名称",key:"name"},{title:"性别",key:"sex"},{title:"出生日期",key:"birthday",align:"center"},{title:"家庭住址",key:"address",align:"center"},{title:"邮政编码",key:"postalCode",align:"center"},{title:"操作",key:"action",align:"center",render(i){return[T(S,{type:"primary",tertiary:!0,size:"small",style:{marginRight:"8px"},onClick:()=>{n(`点击更新： ${i.name}`)}},{default:()=>"更新"}),T(S,{type:"error",tertiary:!0,size:"small",onClick:()=>{t(`点击删除： ${i.name}`)}},{default:()=>"删除"})]}}],s=async()=>g(()=>Y({page:l.value.page??1,size:l.value.pageSize??15}));l.value.onChange=async i=>{l.value.page=i,await s()},l.value.onUpdatePageSize=async i=>{l.value.pageSize=i,await s()};const v=()=>o("点击新增"),a=i=>n(`选中行所绑定的ID值：${i}`),y=w([{label:"序号",key:"id",type:"input",placeholder:"请输入序号",value:""},{label:"名称",key:"name",type:"input",placeholder:"请输入名称",value:""},{label:"性别",key:"sex",type:"select",placeholder:"请选择性别",value:void 0,options:[{label:"男",value:1},{label:"女",value:2}]},{label:"出生日期",key:"birthday",type:"date",placeholder:"请输入出生日期",value:void 0},{label:"家庭住址",key:"address",type:"input",placeholder:"请输入家庭住址",value:""},{label:"邮政编码",key:"postalCode",type:"input",placeholder:"请输入邮政编码",value:""}]),X=()=>o("点击搜索"),N=()=>o("点击重置"),D=()=>o("点击导出"),F=()=>o("点击导入");return G(async()=>{const{total:i}=await s();l.value.pageCount=i}),(i,$)=>(_(),B("div",null,[d(W,{size:"small",loading:h(r),headers:u,data:h(m)||[],pagination:h(l),onCheckedRowKeys:a,onAddData:v},{search:p(()=>[k("div",ne,[d(le,{"search-form-list":h(y),"onUpdate:searchFormList":$[0]||($[0]=C=>x(y)?y.value=C:null),class:"grid grid-cols-4 gap-x-4",onSearch:X,onReset:N},null,8,["search-form-list"])])]),handle:p(()=>[k("div",se,[d(ae,{value:h(e),"onUpdate:value":$[1]||($[1]=C=>x(e)?e.value=C:null),onAdd:v,onExport:D,onInto:F},null,8,["value"])])]),_:1},8,["loading","data","pagination"])]))}});export{ue as default};
