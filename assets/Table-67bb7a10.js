import{f as D,A as E,e as X,b as L}from"./index-4f80df9b.js";import{E as x,I as w,a4 as S,J as c,H as b,a7 as k,ag as V,aI as H,a6 as _,a3 as K,af as v,W as R,a0 as A,L as h,aG as C,bj as N,aK as U,aB as z}from"./vendor-13822149.js";import{u as I}from"./index-44812b81.js";const j=async g=>{const{page:t,size:a}=g;return D({url:"/feature/table",method:"post",data:{page:t,size:a},headers:{Authorization:sessionStorage.getItem(E)}})},F=x({__name:"BaseTableHandle",props:{value:{default:""}},emits:["add","export","search","update:value"],setup(g){return(t,a)=>{const u=H,i=_;return w(),S(V,null,[c(u,{placeholder:"搜索框",autosize:"",size:"small",class:"w-48",value:t.value,"onUpdate:value":a[0]||(a[0]=n=>t.$emit("update:value",n))},{prefix:b(()=>[c(X,{icon:"uil:comment-alt-search"})]),_:1},8,["value"]),c(i,{type:"primary",size:"small",class:"px-4",onClick:a[1]||(a[1]=n=>t.$emit("search"))},{default:b(()=>[k(" 搜索 ")]),_:1}),c(i,{type:"info",size:"small",ghost:"",class:"px-4",onClick:a[2]||(a[2]=n=>t.$emit("export"))},{default:b(()=>[k(" 导出 ")]),_:1}),c(i,{size:"small",class:"px-4",onClick:a[3]||(a[3]=n=>t.$emit("add"))},{default:b(()=>[k(" 新增 ")]),_:1})],64)}}}),J={class:"mb-4 flex items-center justify-end space-x-1"},M=x({name:"BaseTable",__name:"BaseTable",props:{headers:{},data:{},border:{type:Boolean,default:!0},singleColumn:{type:Boolean,default:!1},singleLine:{type:Boolean,default:!1},size:{default:"medium"},striped:{type:Boolean,default:!0},maxHeight:{default:void 0},minHeight:{default:void 0},loading:{type:Boolean,default:!1},pagination:{default:void 0},rowKey:{default:"id"},searchValue:{default:""},scrollX:{default:void 0},isEnableVirtualScroll:{type:Boolean,default:!1}},emits:["checkedRowKeys","update:searchValue","addData","exportExcel","search"],setup(g,{emit:t}){const a=g,u=K(()=>!!(a.isEnableVirtualScroll&&a.maxHeight)),i=e=>e.id,n=v(a.searchValue);R(n,e=>t("update:searchValue",e));const d=()=>t("addData"),s=()=>t("exportExcel"),r=()=>t("search");return(e,o)=>{const p=N;return w(),S("div",null,[A("div",J,[c(F,{value:h(n),"onUpdate:value":o[0]||(o[0]=f=>C(n)?n.value=f:null),onAdd:d,onExport:s,onSearch:r},null,8,["value"])]),c(p,{columns:e.headers,data:e.data,bordered:e.border,"single-column":e.singleColumn,"single-line":e.singleLine,size:e.size,striped:e.striped,"max-height":e.maxHeight,"min-height":e.minHeight,loading:e.loading,pagination:e.pagination,remote:!0,"paginate-single-page":!0,"row-key":i,"scroll-x":e.scrollX,"virtual-scroll":h(u),onUpdateCheckedRowKeys:o[1]||(o[1]=f=>e.$emit("checkedRowKeys",f))},null,8,["columns","data","bordered","single-column","single-line","size","striped","max-height","min-height","loading","pagination","scroll-x","virtual-scroll"])])}}}),P=()=>{const{isLoading:g,withLoading:t}=I(),a=v(),u=v({page:1,pageSize:20,pageSizes:[5,10,15,20,30],pageCount:10,showSizePicker:!0,showQuickJumper:!0});return{isLoading:g,pagination:u,tableData:a,getTableData:async d=>{let s={list:[],total:0};const r=await t(async()=>{const{data:e}=await d();return a.value=e.list,e});return r&&(s=r),s},exportExcel:(d,s,r,e)=>{let o;e?o=XLSX.utils.json_to_sheet(e):o=XLSX.utils.json_to_sheet(a.value??[]);const p=XLSX.utils.book_new();r&&XLSX.utils.sheet_add_aoa(o,[r],{origin:"A1"}),XLSX.utils.book_append_sheet(p,o,d??"Sheet1"),XLSX.writeFile(p,`${s}.xlsx`,{compression:!0})}}},Q=x({__name:"Table",setup(g){const{success:t,error:a,info:u}=L(),i=v(""),{isLoading:n,tableData:d,pagination:s,getTableData:r,exportExcel:e}=P(),o=[{type:"selection"},{title:"序号",key:"id"},{title:"名称",key:"name"},{title:"性别",key:"sex"},{title:"出生日期",key:"birthday",align:"center"},{title:"家庭住址",key:"address",align:"center"},{title:"邮政编码",key:"postalCode",align:"center"},{title:"操作",key:"action",align:"center",render(l){return[z(_,{type:"primary",tertiary:!0,size:"small",style:{marginRight:"8px"},onClick:()=>{t(`点击更新： ${l.name}`)}},{default:()=>"更新"}),z(_,{type:"error",tertiary:!0,size:"small",onClick:()=>{a(`点击删除： ${l.name}`)}},{default:()=>"删除"})]}}],p=async()=>r(()=>j({page:s.value.page??1,size:s.value.pageSize??15}));s.value.onChange=async l=>{s.value.page=l,await p()},s.value.onUpdatePageSize=async l=>{s.value.pageSize=l,await p()};const f=()=>{var y;const l=(y=d.value)==null?void 0:y.map(m=>({name:m.name,birthday:m.birthday,address:m.address,postalCode:m.postalCode,sex:m.sex}));e("Sheet1","基础表格文件",["名称","出生日期","家庭住址","邮政编码","性别"],l)},T=()=>u("搜索数据"),$=()=>u("点击新增"),B=l=>t(`选中行所绑定的ID值：${l}`);return U(async()=>{const{total:l}=await p();s.value.pageCount=l}),(l,y)=>(w(),S("div",null,[c(M,{"search-value":h(i),"onUpdate:searchValue":y[0]||(y[0]=m=>C(i)?i.value=m:null),size:"small",loading:h(n),headers:o,data:h(d)||[],pagination:h(s),onSearch:T,onCheckedRowKeys:B,onAddData:$,onExportExcel:f},null,8,["search-value","loading","data","pagination"])]))}});export{Q as default};
