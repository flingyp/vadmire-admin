import{E as L,a5 as F,F as y,a6 as B,I as x,L as p,M as f,bm as U,a2 as k,H as d,a9 as b,a8 as S,bn as V,ah as w,Y as E,G as h,aj as K,ai as H,b8 as I,b9 as A,ac as j,aI as M,aR as P,bo as G,aK as q,aG as T,aB as X}from"./vendor_1694166525858-3db87f0b.js";import{h as J,A as O,c as Q,b as Y}from"./index-80056b73.js";const W=async c=>{const{page:o,size:t}=c;return J({url:"/feature/table",method:"post",data:{page:o,size:t},headers:{Authorization:sessionStorage.getItem(O)}})},Z=L({name:"BaseTable",__name:"BaseTable",props:{headers:{},data:{},border:{type:Boolean,default:!0},singleColumn:{type:Boolean,default:!1},singleLine:{type:Boolean,default:!1},size:{default:"medium"},striped:{type:Boolean,default:!0},maxHeight:{default:void 0},minHeight:{default:void 0},loading:{type:Boolean,default:!1},pagination:{default:void 0},rowKey:{default:"id"},searchValue:{default:""},scrollX:{default:void 0},isEnableVirtualScroll:{type:Boolean,default:!1}},emits:["checkedRowKeys"],setup(c){const o=c,t=F(()=>!!(o.isEnableVirtualScroll&&o.maxHeight)),n=e=>e.id;return(e,u)=>{const s=U;return y(),B("div",null,[x(e.$slots,"search"),x(e.$slots,"handle"),p(s,{columns:e.headers,data:e.data,bordered:e.border,"single-column":e.singleColumn,"single-line":e.singleLine,size:e.size,striped:e.striped,"max-height":e.maxHeight,"min-height":e.minHeight,loading:e.loading,pagination:e.pagination,remote:!0,"paginate-single-page":!0,"row-key":n,"scroll-x":e.scrollX,"virtual-scroll":f(t),onUpdateCheckedRowKeys:u[0]||(u[0]=l=>e.$emit("checkedRowKeys",l))},null,8,["columns","data","bordered","single-column","single-line","size","striped","max-height","min-height","loading","pagination","scroll-x","virtual-scroll"])])}}}),ee={class:"w-full flex items-center justify-between"},ae={class:"space-x-2"},te=L({__name:"BaseTableHandle",props:{value:{default:""}},emits:["add","into","export"],setup(c){return(o,t)=>{const n=S;return y(),B("div",ee,[k("div",null,[p(n,{type:"primary",size:"small",class:"px-6 py-2",onClick:t[0]||(t[0]=e=>o.$emit("add"))},{default:d(()=>[b(" 新增 ")]),_:1})]),k("div",ae,[p(n,{type:"primary",size:"small",class:"px-6 py-2",onClick:t[1]||(t[1]=e=>o.$emit("into"))},{default:d(()=>[b(" 导入 ")]),_:1}),p(n,{type:"info",size:"small",ghost:"",class:"px-6 py-2",onClick:t[2]||(t[2]=e=>o.$emit("export"))},{default:d(()=>[b(" 导出 ")]),_:1})])])}}}),le={class:"space-x-2"},oe=L({__name:"BaseTableSearch",props:{searchFormList:{type:Array,default:()=>[]}},emits:["update:searchFormList","search","reset"],setup(c,{emit:o}){const t=c,{searchFormList:n}=V(t),e=w(n.value);return E(e,u=>{o("update:searchFormList",u)},{deep:!0}),(u,s)=>{const l=M,m=P,g=G,i=I,v=S,C=A;return y(),h(C,{"label-placement":"left","label-width":"auto"},{default:d(()=>[(y(!0),B(H,null,K(f(e),a=>(y(),h(i,{key:a.key,label:a.label},{default:d(()=>[a.type==="input"?(y(),h(l,{key:0,value:a.value,"onUpdate:value":_=>a.value=_,placeholder:a.placeholder},null,8,["value","onUpdate:value","placeholder"])):a.type==="select"?(y(),h(m,{key:1,value:a.value,"onUpdate:value":_=>a.value=_,placeholder:a.placeholder,options:a.options},null,8,["value","onUpdate:value","placeholder","options"])):a.type==="date"?(y(),h(g,{key:2,"formatted-value":a.value,"onUpdate:formattedValue":_=>a.value=_,type:"date",class:"w-full",placeholder:a.placeholder},null,8,["formatted-value","onUpdate:formattedValue","placeholder"])):j("",!0)]),_:2},1032,["label"]))),128)),p(i,null,{default:d(()=>[k("div",le,[p(v,{type:"primary",class:"px-6",onClick:s[0]||(s[0]=a=>u.$emit("search"))},{default:d(()=>[b(" 搜索 ")]),_:1}),p(v,{type:"primary",class:"px-6",ghost:"",onClick:s[1]||(s[1]=a=>u.$emit("reset"))},{default:d(()=>[b(" 重置 ")]),_:1})])]),_:1})]),_:1})}}}),ne=()=>{const{isLoading:c,withLoading:o}=Q(),t=w(),n=w({page:1,pageSize:20,pageSizes:[5,10,15,20,30],pageCount:10,showSizePicker:!0,showQuickJumper:!0});return{isLoading:c,pagination:n,tableData:t,getTableData:async s=>{let l={list:[],total:0};const m=await o(async()=>{const{data:g}=await s();return t.value=g.list,g});return m&&(l=m),l},exportExcel:(s,l,m,g)=>{let i;g?i=XLSX.utils.json_to_sheet(g):i=XLSX.utils.json_to_sheet(t.value??[]);const v=XLSX.utils.book_new();m&&XLSX.utils.sheet_add_aoa(i,[m],{origin:"A1"}),XLSX.utils.book_append_sheet(v,i,s??"Sheet1"),XLSX.writeFile(v,`${l}.xlsx`,{compression:!0})}}},se={class:"border border-vBorderLight dark:border-vBorderDark rounded p-4 mb-2"},ie={class:"mb-2 flex items-center justify-end space-x-1"},de=L({__name:"Table",setup(c){const{success:o,error:t,info:n}=Y(),e=w(""),{isLoading:u,tableData:s,pagination:l,getTableData:m}=ne(),g=[{type:"selection"},{title:"序号",key:"id"},{title:"名称",key:"name"},{title:"性别",key:"sex"},{title:"出生日期",key:"birthday",align:"center"},{title:"家庭住址",key:"address",align:"center"},{title:"邮政编码",key:"postalCode",align:"center"},{title:"操作",key:"action",align:"center",render(r){return[X(S,{type:"primary",tertiary:!0,size:"small",style:{marginRight:"8px"},onClick:()=>{o(`点击更新： ${r.name}`)}},{default:()=>"更新"}),X(S,{type:"error",tertiary:!0,size:"small",onClick:()=>{t(`点击删除： ${r.name}`)}},{default:()=>"删除"})]}}],i=async()=>m(()=>W({page:l.value.page??1,size:l.value.pageSize??15}));l.value.onChange=async r=>{l.value.page=r,await i()},l.value.onUpdatePageSize=async r=>{l.value.pageSize=r,await i()};const v=()=>n("点击新增"),C=r=>o(`选中行所绑定的ID值: ${r}`),a=w([{label:"序号",key:"id",type:"input",placeholder:"请输入序号",value:""},{label:"名称",key:"name",type:"input",placeholder:"请输入名称",value:""},{label:"性别",key:"sex",type:"select",placeholder:"请选择性别",value:void 0,options:[{label:"男",value:1},{label:"女",value:2}]},{label:"出生日期",key:"birthday",type:"date",placeholder:"请输入出生日期",value:void 0},{label:"家庭住址",key:"address",type:"input",placeholder:"请输入家庭住址",value:""},{label:"邮政编码",key:"postalCode",type:"input",placeholder:"请输入邮政编码",value:""}]),_=()=>n("点击搜索"),N=()=>n("点击重置"),R=()=>n("点击导出"),D=()=>n("点击导入");return q(async()=>{const{total:r}=await i();l.value.pageCount=r}),(r,$)=>(y(),B("div",null,[p(Z,{size:"small",loading:f(u),headers:g,data:f(s)||[],pagination:f(l),onCheckedRowKeys:C,onAddData:v},{search:d(()=>[k("div",se,[p(oe,{"search-form-list":f(a),"onUpdate:searchFormList":$[0]||($[0]=z=>T(a)?a.value=z:null),class:"grid grid-cols-4 gap-x-4",onSearch:_,onReset:N},null,8,["search-form-list"])])]),handle:d(()=>[k("div",ie,[p(te,{value:f(e),"onUpdate:value":$[1]||($[1]=z=>T(e)?e.value=z:null),onAdd:v,onExport:R,onInto:D},null,8,["value"])])]),_:1},8,["loading","data","pagination"])]))}});export{de as default};
