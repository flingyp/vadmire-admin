import{x as k,B as v,Y as w,C as d,bc as T,A as f,a0 as z,a9 as $,aB as L,$ as _,a8 as b,aD as X,U as D,E as h,az as R,au as x}from"./vendor-49e58c46.js";import{f as K,A as V,e as E,b as N}from"./index-e1cb1f44.js";import{u as A}from"./index-a7a0bc3c.js";const U=async p=>{const{page:s,size:e}=p;return K({url:"/feature/table",method:"post",data:{page:s,size:e},headers:{Authorization:sessionStorage.getItem(V)}})},H=k({name:"BaseTable",__name:"BaseTable",props:{headers:{},data:{},border:{type:Boolean,default:!0},singleColumn:{type:Boolean,default:!1},singleLine:{type:Boolean,default:!1},size:{default:"medium"},striped:{type:Boolean,default:!0},maxHeight:{default:void 0},loading:{type:Boolean,default:!1},pagination:{default:void 0},rowKey:{default:"id"}},emits:["checkedRowKeys"],setup(p){const s=e=>e.id;return(e,o)=>{const n=T;return v(),w("div",null,[d(n,{columns:e.headers,data:e.data,bordered:e.border,"single-column":e.singleColumn,"single-line":e.singleLine,size:e.size,striped:e.striped,"max-height":e.maxHeight,loading:e.loading,pagination:e.pagination,remote:!0,"paginate-single-page":!0,"row-key":s,onUpdateCheckedRowKeys:o[0]||(o[0]=l=>e.$emit("checkedRowKeys",l))},null,8,["columns","data","bordered","single-column","single-line","size","striped","max-height","loading","pagination"])])}}}),F=k({__name:"BaseTableHandle",props:{searchValue:{default:""}},emits:["add","export","update:searchValue"],setup(p){return(s,e)=>{const o=L,n=_;return v(),w($,null,[d(o,{placeholder:"搜索框",autosize:"",size:"small",class:"w-48","onUpdate:value":e[0]||(e[0]=l=>s.$emit("update:searchValue",l))},{prefix:f(()=>[d(E,{icon:"uil:comment-alt-search"})]),_:1}),d(n,{type:"info",size:"small",ghost:"",class:"px-4",onClick:e[1]||(e[1]=l=>s.$emit("export"))},{default:f(()=>[z(" 导出 ")]),_:1}),d(n,{type:"primary",size:"small",class:"px-4",onClick:e[2]||(e[2]=l=>s.$emit("add"))},{default:f(()=>[z(" 新增 ")]),_:1})],64)}}}),j=()=>{const{isLoading:p,withLoading:s}=A(),e=b(),o=b({page:1,pageSize:20,pageSizes:[5,10,15,20,30],pageCount:10,showSizePicker:!0,showQuickJumper:!0});return{isLoading:p,pagination:o,tableData:e,getTableData:async c=>{let a={list:[],total:0};const i=await s(async()=>{const{data:r}=await c();return e.value=r.list,r});return i&&(a=i),a},exportExcel:(c,a,i,r)=>{let g;r?g=XLSX.utils.json_to_sheet(r):g=XLSX.utils.json_to_sheet(e.value??[]);const m=XLSX.utils.book_new();i&&XLSX.utils.sheet_add_aoa(g,[i],{origin:"A1"}),XLSX.utils.book_append_sheet(m,g,c??"Sheet1"),XLSX.writeFile(m,`${a}.xlsx`,{compression:!0})}}},I={class:"mb-4 flex items-center space-x-1"},J=k({__name:"Table",setup(p){const{success:s,error:e,info:o}=N(),n=b(""),{isLoading:l,tableData:c,pagination:a,getTableData:i,exportExcel:r}=j(),g=[{type:"selection"},{title:"序号",key:"id"},{title:"名称",key:"name"},{title:"性别",key:"sex"},{title:"出生日期",key:"birthday",align:"center"},{title:"家庭住址",key:"address",align:"center"},{title:"邮政编码",key:"postalCode",align:"center"},{title:"操作",key:"action",align:"center",render(t){return[x(_,{type:"primary",tertiary:!0,size:"small",style:{marginRight:"8px"},onClick:()=>{s(`点击更新： ${t.name}`)}},{default:()=>"更新"}),x(_,{type:"error",tertiary:!0,size:"small",onClick:()=>{e(`点击删除： ${t.name}`)}},{default:()=>"删除"})]}}],m=async()=>i(()=>U({page:a.value.page??1,size:a.value.pageSize??15}));a.value.onChange=async t=>{a.value.page=t,await m()},a.value.onUpdatePageSize=async t=>{a.value.pageSize=t,await m()};const C=()=>{var y;const t=(y=c.value)==null?void 0:y.map(u=>({name:u.name,birthday:u.birthday,address:u.address,postalCode:u.postalCode,sex:u.sex}));r("Sheet1","基础表格文件",["名称","出生日期","家庭住址","邮政编码","性别"],t)},B=()=>{o("点击新增")},S=t=>{};return X(async()=>{const{total:t}=await m();a.value.pageCount=t}),(t,y)=>(v(),w("div",null,[D("div",I,[d(F,{"search-value":h(n),"onUpdate:searchValue":y[0]||(y[0]=u=>R(n)?n.value=u:null),onAdd:B,onExport:C},null,8,["search-value"])]),d(H,{size:"small",loading:h(l),headers:g,data:h(c),pagination:h(a),onCheckedRowKeys:S},null,8,["loading","data","pagination"])]))}});export{J as default};
