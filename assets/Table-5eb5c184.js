import{r as S,t as v,A as z,W as k,B as u,b9 as w,z as h,Z as x,a7 as $,ax as L,Y as y,a6 as b,at as X,R as D,D as f,av as V,aH as C}from"./vendor-8f0bbe3c.js";import{_ as N}from"./RenderIconify.vue_vue_type_script_lang-75a88215.js";import{e as A,A as E,b as H}from"./index-228ae075.js";import{u as R}from"./index-7529f9af.js";const U=async p=>{const{page:e,size:a}=p;return A({url:"/feature/table",method:"post",data:{page:e,size:a},headers:{Authorization:S(E)}})},F=v({name:"BaseTable",__name:"BaseTable",props:{headers:{},data:{},border:{type:Boolean,default:!0},singleColumn:{type:Boolean,default:!1},singleLine:{type:Boolean,default:!1},size:{default:"medium"},striped:{type:Boolean,default:!0},maxHeight:{default:void 0},loading:{type:Boolean,default:!1},pagination:{default:void 0}},setup(p){return(e,a)=>{const n=w;return z(),k("div",null,[u(n,{columns:e.headers,data:e.data,bordered:e.border,"single-column":e.singleColumn,"single-line":e.singleLine,size:e.size,striped:e.striped,"max-height":e.maxHeight,loading:e.loading,pagination:e.pagination,remote:!0,"paginate-single-page":!0},null,8,["columns","data","bordered","single-column","single-line","size","striped","max-height","loading","pagination"])])}}}),j=v({__name:"BaseTableHandle",props:{searchValue:{default:""}},emits:["add","export","update:searchValue"],setup(p){return(e,a)=>{const n=L,o=y;return z(),k($,null,[u(n,{placeholder:"搜索框",autosize:"",size:"small",class:"w-48","onUpdate:value":a[0]||(a[0]=d=>e.$emit("update:searchValue",d))},{prefix:h(()=>[u(N,{icon:"uil:comment-alt-search"})]),_:1}),u(o,{type:"info",size:"small",ghost:"",class:"px-4",onClick:a[1]||(a[1]=d=>e.$emit("export"))},{default:h(()=>[x(" 导出 ")]),_:1}),u(o,{type:"primary",size:"small",class:"px-4",onClick:a[2]||(a[2]=d=>e.$emit("add"))},{default:h(()=>[x(" 新增 ")]),_:1})],64)}}}),M=()=>{const{isLoading:p,withLoading:e}=R(),a=b(),n=b({page:1,pageSize:20,pageSizes:[5,10,15,20,30],pageCount:10,showSizePicker:!0,showQuickJumper:!0});return{isLoading:p,pagination:n,tableData:a,getTableData:async c=>{let t={list:[],total:0};const l=await e(async()=>{const{data:i}=await c();return a.value=i.list,i});return l&&(t=l),t},exportExcel:(c,t,l,i)=>{let g;i?g=XLSX.utils.json_to_sheet(i):g=XLSX.utils.json_to_sheet(a.value??[]);const m=XLSX.utils.book_new();l&&XLSX.utils.sheet_add_aoa(g,[l],{origin:"A1"}),XLSX.utils.book_append_sheet(m,g,c??"Sheet1"),XLSX.writeFile(m,`${t}.xlsx`,{compression:!0})}}},P={class:"mb-4 flex items-center space-x-1"},O=v({__name:"Table",setup(p){const{success:e,error:a,info:n}=H(),o=b(""),{isLoading:d,tableData:c,pagination:t,getTableData:l,exportExcel:i}=M(),g=[{title:"序号",key:"id"},{title:"名称",key:"name"},{title:"性别",key:"sex"},{title:"出生日期",key:"birthday",align:"center"},{title:"家庭住址",key:"address",align:"center"},{title:"邮政编码",key:"postalCode",align:"center"},{title:"操作",key:"action",align:"center",render(s){return[C(y,{type:"primary",tertiary:!0,size:"small",style:{marginRight:"8px"},onClick:()=>{e(`点击更新： ${s.name}`)}},{default:()=>"更新"}),C(y,{type:"error",tertiary:!0,size:"small",onClick:()=>{a(`点击删除： ${s.name}`)}},{default:()=>"删除"})]}}],m=async()=>l(()=>U({page:t.value.page??1,size:t.value.pageSize??15}));t.value.onChange=async s=>{t.value.page=s,await m()},t.value.onUpdatePageSize=async s=>{t.value.pageSize=s,await m()};const T=()=>{var _;const s=(_=c.value)==null?void 0:_.map(r=>({name:r.name,birthday:r.birthday,address:r.address,postalCode:r.postalCode,sex:r.sex}));i("Sheet1","基础表格文件",["名称","出生日期","家庭住址","邮政编码","性别"],s)},B=()=>{n("点击新增")};return X(async()=>{const{total:s}=await m();t.value.pageCount=s}),(s,_)=>(z(),k("div",null,[D("div",P,[u(j,{"search-value":f(o),"onUpdate:searchValue":_[0]||(_[0]=r=>V(o)?o.value=r:null),onAdd:B,onExport:T},null,8,["search-value"])]),u(F,{size:"small",loading:f(d),headers:g,data:f(c),pagination:f(t)},null,8,["loading","data","pagination"])]))}});export{O as default};
